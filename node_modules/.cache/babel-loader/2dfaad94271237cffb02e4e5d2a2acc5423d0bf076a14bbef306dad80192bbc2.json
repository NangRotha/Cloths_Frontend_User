{"ast":null,"code":"import _objectWithoutProperties from\"/Users/rotha/Documents/Project /Cloth/frontend-user/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"access_token\"];import React,{createContext,useState,useContext,useEffect}from'react';import{authAPI}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[isAuthenticated,setIsAuthenticated]=useState(false);const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const token=localStorage.getItem('token');if(token){// Verify token and get user info\nfetchUserProfile();}else{setLoading(false);}},[]);const fetchUserProfile=async()=>{try{console.log('Fetching user profile...');const response=await authAPI.getProfile();console.log('User profile response:',response.data);setUser(response.data);setIsAuthenticated(true);}catch(error){console.error('Error fetching user profile:',error);localStorage.removeItem('token');setIsAuthenticated(false);setUser(null);}finally{setLoading(false);}};const login=async credentials=>{try{console.log('Attempting login...');const response=await authAPI.login(credentials);console.log('Login response:',response.data);const _response$data=response.data,{access_token}=_response$data,userData=_objectWithoutProperties(_response$data,_excluded);localStorage.setItem('token',access_token);setUser(userData);setIsAuthenticated(true);return{success:true};}catch(error){var _error$response,_error$response$data;console.error('Login error:',error);let errorMessage='áž€áž¶ážšáž…áž¼áž›áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹áž”ážšáž¶áž‡áŸáž™';if((_error$response=error.response)!==null&&_error$response!==void 0&&(_error$response$data=_error$response.data)!==null&&_error$response$data!==void 0&&_error$response$data.detail){if(Array.isArray(error.response.data.detail)){errorMessage=error.response.data.detail.map(err=>err.msg).join(', ');}else{errorMessage=error.response.data.detail;}}return{success:false,error:errorMessage};}};const register=async userData=>{try{console.log('Attempting registration...');const response=await authAPI.register(userData);console.log('Registration response:',response.data);return{success:true};}catch(error){var _error$response2,_error$response2$data;console.error('Registration error:',error);let errorMessage='áž€áž¶ážšáž…áž»áŸ‡ážˆáŸ’áž˜áŸ„áŸ‡áž”ážšáž¶áž‡áŸáž™áŸ” ážŸáž¼áž˜áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážáž„áž‘áŸ€ážáŸ”';if((_error$response2=error.response)!==null&&_error$response2!==void 0&&(_error$response2$data=_error$response2.data)!==null&&_error$response2$data!==void 0&&_error$response2$data.detail){if(Array.isArray(error.response.data.detail)){errorMessage=error.response.data.detail.map(err=>err.msg).join(', ');}else{errorMessage=error.response.data.detail;}}return{success:false,error:errorMessage};}};const loginWithGoogle=async token=>{try{localStorage.setItem('token',token);// Fetch user profile with the Google token\nconst response=await authAPI.getProfile();setUser(response.data);setIsAuthenticated(true);return{success:true};}catch(error){console.error('Google login error:',error);localStorage.removeItem('token');return{success:false,error:'áž€áž¶ážšáž—áŸ’áž‡áž¶áž”áŸ‹áž‡áž¶áž˜áž½áž™ Google áž”ážšáž¶áž‡áŸáž™'};}};const googleLogin=()=>{// Check if Google OAuth is available by testing the endpoint first\nfetch('http://localhost:8000/api/auth/google').then(response=>{if(!response.ok){// If not configured, redirect to setup instructions\nwindow.location.href='http://localhost:8000/api/auth/google';return;}// If the endpoint is working, redirect to Google OAuth\nwindow.location.href='http://localhost:8000/api/auth/google';}).catch(error=>{console.error('Google OAuth not available:',error);// Show helpful setup instructions\nalert(\"\\uD83D\\uDD27 Google OAuth Setup Required:\\n\\n1. Go to: https://console.cloud.google.com/\\n2. Create project \\u2192 Enable APIs (Google+ API, Google OAuth2 API)\\n3. Create OAuth 2.0 Client ID\\n4. Add redirect URI: http://localhost:8000/api/auth/google/callback\\n5. Copy Client ID and Client Secret\\n6. Edit: /Users/rotha/Documents/Project /Cloth/backend/.env\\n7. Replace lines 9-10 with your actual credentials\\n\\nFile location: /Users/rotha/Documents/Project /Cloth/backend/.env\\n\\nAfter setup, Google login will work automatically!\");});};const logout=()=>{setIsAuthenticated(false);setUser(null);localStorage.removeItem('token');};const value={isAuthenticated,user,loading,login,register,loginWithGoogle,googleLogin,logout};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","authAPI","jsx","_jsx","AuthContext","useAuth","context","Error","AuthProvider","_ref","children","isAuthenticated","setIsAuthenticated","user","setUser","loading","setLoading","token","localStorage","getItem","fetchUserProfile","console","log","response","getProfile","data","error","removeItem","login","credentials","_response$data","access_token","userData","_objectWithoutProperties","_excluded","setItem","success","_error$response","_error$response$data","errorMessage","detail","Array","isArray","map","err","msg","join","register","_error$response2","_error$response2$data","loginWithGoogle","googleLogin","fetch","then","ok","window","location","href","catch","alert","logout","value","Provider"],"sources":["/Users/rotha/Documents/Project /Cloth/frontend-user/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\nimport { authAPI } from '../services/api';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      // Verify token and get user info\n      fetchUserProfile();\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  const fetchUserProfile = async () => {\n    try {\n      console.log('Fetching user profile...');\n      const response = await authAPI.getProfile();\n      console.log('User profile response:', response.data);\n      setUser(response.data);\n      setIsAuthenticated(true);\n    } catch (error) {\n      console.error('Error fetching user profile:', error);\n      localStorage.removeItem('token');\n      setIsAuthenticated(false);\n      setUser(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const login = async (credentials) => {\n    try {\n      console.log('Attempting login...');\n      const response = await authAPI.login(credentials);\n      console.log('Login response:', response.data);\n      \n      const { access_token, ...userData } = response.data;\n      \n      localStorage.setItem('token', access_token);\n      setUser(userData);\n      setIsAuthenticated(true);\n      \n      return { success: true };\n    } catch (error) {\n      console.error('Login error:', error);\n      \n      let errorMessage = 'áž€áž¶ážšáž…áž¼áž›áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹áž”ážšáž¶áž‡áŸáž™';\n      \n      if (error.response?.data?.detail) {\n        if (Array.isArray(error.response.data.detail)) {\n          errorMessage = error.response.data.detail.map(err => err.msg).join(', ');\n        } else {\n          errorMessage = error.response.data.detail;\n        }\n      }\n      \n      return { success: false, error: errorMessage };\n    }\n  };\n    const register = async (userData) => {\n    try {\n      console.log('Attempting registration...');\n      const response = await authAPI.register(userData);\n      console.log('Registration response:', response.data);\n      return { success: true };\n    } catch (error) {\n      console.error('Registration error:', error);\n      \n      let errorMessage = 'áž€áž¶ážšáž…áž»áŸ‡ážˆáŸ’áž˜áŸ„áŸ‡áž”ážšáž¶áž‡áŸáž™áŸ” ážŸáž¼áž˜áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážáž„áž‘áŸ€ážáŸ”';\n      \n      if (error.response?.data?.detail) {\n        if (Array.isArray(error.response.data.detail)) {\n          errorMessage = error.response.data.detail.map(err => err.msg).join(', ');\n        } else {\n          errorMessage = error.response.data.detail;\n        }\n      }\n      \n      return { success: false, error: errorMessage };\n    }\n  };\n\n  const loginWithGoogle = async (token) => {\n    try {\n      localStorage.setItem('token', token);\n      // Fetch user profile with the Google token\n      const response = await authAPI.getProfile();\n      setUser(response.data);\n      setIsAuthenticated(true);\n      return { success: true };\n    } catch (error) {\n      console.error('Google login error:', error);\n      localStorage.removeItem('token');\n      return { success: false, error: 'áž€áž¶ážšáž—áŸ’áž‡áž¶áž”áŸ‹áž‡áž¶áž˜áž½áž™ Google áž”ážšáž¶áž‡áŸáž™' };\n    }\n  };\n\n  const googleLogin = () => {\n    // Check if Google OAuth is available by testing the endpoint first\n    fetch('http://localhost:8000/api/auth/google')\n      .then(response => {\n        if (!response.ok) {\n          // If not configured, redirect to setup instructions\n          window.location.href = 'http://localhost:8000/api/auth/google';\n          return;\n        }\n        // If the endpoint is working, redirect to Google OAuth\n        window.location.href = 'http://localhost:8000/api/auth/google';\n      })\n      .catch(error => {\n        console.error('Google OAuth not available:', error);\n        // Show helpful setup instructions\n        alert(`ðŸ”§ Google OAuth Setup Required:\n\n1. Go to: https://console.cloud.google.com/\n2. Create project â†’ Enable APIs (Google+ API, Google OAuth2 API)\n3. Create OAuth 2.0 Client ID\n4. Add redirect URI: http://localhost:8000/api/auth/google/callback\n5. Copy Client ID and Client Secret\n6. Edit: /Users/rotha/Documents/Project /Cloth/backend/.env\n7. Replace lines 9-10 with your actual credentials\n\nFile location: /Users/rotha/Documents/Project /Cloth/backend/.env\n\nAfter setup, Google login will work automatically!`);\n      });\n  };\n\n  const logout = () => {\n    setIsAuthenticated(false);\n    setUser(null);\n    localStorage.removeItem('token');\n  };\n\n  const value = {\n    isAuthenticated,\n    user,\n    loading,\n    login,\n    register,\n    loginWithGoogle,\n    googleLogin,\n    logout,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}